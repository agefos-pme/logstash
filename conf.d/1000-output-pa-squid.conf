output {

  stdout {
    codec => rubydebug
  }

  if [type] == "syslog-reseau" and "pa_traffic_groked" in [tags] {

    elasticsearch {
      host => localhost
      index => "pa-traffic-%{+YYYY.MM.dd}"
      template => "/etc/logstash/templates/pa-traffic.json"
      template_name => "pa-traffic"
      template_overwrite => true
      manage_template => true
    }

   } else if [type] == "syslog-reseau" and "pa_traffic_ungroked" in [tags] {

    elasticsearch {
      host => localhost
      index => "pa-traffic-ungroked-%{+YYYY.MM.dd}"
      template => "/etc/logstash/templates/pa-traffic.json"
      template_name => "pa-traffic"
      template_overwrite => true
      manage_template => true
    }

  } else if [type] == "syslog-reseau" and "pa_threat_groked" in [tags] {

    elasticsearch {
      host => localhost
      index => "pa-threat-%{+YYYY.MM.dd}"
      template => "/etc/logstash/templates/pa-threat.json"
      template_name => "pa-threat"
      template_overwrite => true
      manage_template => true
    }

  } else if [type] == "syslog-reseau" and "pa_threat_ungroked" in [tags] {

    elasticsearch {
      host => localhost
      index => "pa-threat-ungroked-%{+YYYY.MM.dd}"
      template => "/etc/logstash/templates/pa-threat.json"
      template_name => "pa-threat"
      template_overwrite => true
      manage_template => true
    }

  } else if [type] == "syslog-reseau" and "squid_groked" in [tags] {

    elasticsearch {
      host => localhost
      index => "squid-groked-%{+YYYY.MM.dd}"
      template => "/etc/logstash/templates/squid.json"
      template_name => "squid"
      template_overwrite => true
      manage_template => true
    }

  } else if [type] == "syslog-reseau" and "squid_ungroked" in [tags] {

    elasticsearch {
      host => localhost
      index => "squid-ungroked-%{+YYYY.MM.dd}"
      template => "/etc/logstash/templates/squid.json"
      template_name => "squid"
      template_overwrite => true
      manage_template => true
    }
  }
}
